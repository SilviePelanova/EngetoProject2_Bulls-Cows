import random
import time
from datetime import timedelta

# Definition to count elapsed time
def count_elapsed_time(end_time, start_time):
    elapsed_time = round(end_time - start_time)
    converted_elapsed_time = timedelta(seconds=elapsed_time)
    return str(converted_elapsed_time).split(":")

# variable to set up numbers possible to use for random number
list_numbers = list(range(0,10))

# definition of function creating random 4 digit number which does not strat with 0 and digits are not repeating
def create_guess_number():
    random_numbers = []
    first_number = random.choice(list_numbers[1:])
    random_numbers.append(first_number)
    list_numbers.remove(first_number)
    second_number = random.choice(list_numbers)
    random_numbers.append(second_number)
    list_numbers.remove(second_number)
    third_number = random.choice(list_numbers)
    random_numbers.append(third_number)
    list_numbers.remove(third_number)
    forth_number = random.choice(list_numbers)
    random_numbers.append(forth_number)
    return "".join(map(str, random_numbers))

# number which is being guessed
guess_number = create_guess_number()
print(guess_number)

separator = "-" * 47

# welcome message
print(f"Hi there! \n{separator} \nI'have generated a random {len(guess_number)} digit number for you. \nLet's play a bulls and cows game!")
print(separator)

print("Enter a number:")
print(separator)

# variable to count number of cycles
while_loop_counter = 0
start_counter_on = False

# number validation through while loop
while True:
    # variables to count bulls a cows
    bulls = 0
    cows = 0
 
    # request to enter input number
    input_number = input(">>> ")

    # start time counter
    if start_counter_on == False: 
        start_time = time.time()
         
    # number in numeric, is not empty, not starting with 0 and not shorter/longer then 4
    if input_number.isdigit() == False:
        print(f"Incorret input, please, enter {len(guess_number)} digit number!")
    elif input_number[0] == "0":
        print(f"Incorret input, please, enter {len(guess_number)} digit number not starting with 0!")
    elif len(input_number) != len(guess_number):
        print(f"Incorret input, please, enter {len(guess_number)} digit number!")
    elif len(input_number) != len(set(input_number)):
        print("Incorrect input, please, enter a number with non-repeating digits.")
    # same numbers => count plus 1 in while loop counter
    elif input_number == guess_number:
        
        if start_counter_on == False: 
            start_counter_on = True

        while_loop_counter += 1    
                
        # stop time counter
        end_time = time.time()       
        formated_elapsed_time = count_elapsed_time(end_time,start_time)

        # result print
        if while_loop_counter == 1:
            print(f"Correct, you've guessed the right number in {while_loop_counter} guess! \nThat's amazing!") 
        elif while_loop_counter > 1 and while_loop_counter <= 5:
            print(f"Correct, you've guessed the right number in {while_loop_counter} guesses! \nThat's amazing!")                  
        elif while_loop_counter > 5 and while_loop_counter < 15:
            print(f"Correct, you've guessed the right number in {while_loop_counter} guesses! \nThat's average.")
        else:
            print(f"Correct, you've guessed the right number in {while_loop_counter} guesses! \nThat's not so good.")
            print(separator)
            
        print(f"You have guessed the right number in {formated_elapsed_time[0]} h {formated_elapsed_time[1]} m {formated_elapsed_time[2]} s.")
        print(separator)
        quit()
    
    # different numbers (input nr. is not equal guessed nr.) => count plus 1 in while loop counter
    else:
        if start_counter_on == False: 
            start_counter_on = True

        while_loop_counter += 1  
        
        for digit_i in range(0, len(input_number)):        
            if input_number[digit_i] == guess_number[digit_i]:
                bulls += 1
                            
            for digit_j in range(0, len(guess_number)):            
                if input_number[digit_i] == guess_number[digit_j] and input_number[digit_i] != guess_number[digit_i]:
                    cows += 1         

        # list bull/bulls and cow/cows based on numbers in variables cows/bulls
        if cows == 1 and bulls == 1:
            print(f"{cows} cow {bulls} bull")
        elif cows == 1 and bulls != 1 :
            print(f"{cows} cow {bulls} bulls")
        elif cows != 1 and bulls == 1:
            print(f"{cows} cows {bulls} bull" )
        else:
            print(f"{cows} cows {bulls} bulls")

    print(separator)
    